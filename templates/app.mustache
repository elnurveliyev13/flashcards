 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#0B1220">
<div id="mod_flashcards_container"
     data-ai-click="{{#str}} ai_click_hint, mod_flashcards {{/str}}"
     data-ai-disabled="{{#str}} ai_helper_disabled, mod_flashcards {{/str}}"
     data-ai-detecting="{{#str}} ai_detecting, mod_flashcards {{/str}}"
     data-ai-success="{{#str}} ai_helper_success, mod_flashcards {{/str}}"
     data-ai-error="{{#str}} ai_helper_error, mod_flashcards {{/str}}"
     data-ai-no-text="{{#str}} ai_no_text, mod_flashcards {{/str}}"
     data-token-create-card="{{#str}} token_create_card, mod_flashcards {{/str}}"
     data-token-create-card-status="{{#str}} token_create_card_status, mod_flashcards {{/str}}"
     data-ai-chat-empty="{{#str}} ai_chat_empty, mod_flashcards {{/str}}"
     data-ai-chat-user="{{#str}} ai_chat_user, mod_flashcards {{/str}}"
     data-ai-chat-assistant="{{#str}} ai_chat_assistant, mod_flashcards {{/str}}"
     data-ai-chat-loading="{{#str}} ai_chat_loading, mod_flashcards {{/str}}"
     data-ai-chat-error="{{#str}} ai_chat_error, mod_flashcards {{/str}}"
     data-focus-audio-label="{{#str}} focus_audio_badge, mod_flashcards {{/str}}"
     data-front-audio-label="{{#str}} front_audio_badge, mod_flashcards {{/str}}"
     data-voice-placeholder="{{#str}} tts_voice_placeholder, mod_flashcards {{/str}}"
     data-voice-missing="{{#str}} tts_voice_missing, mod_flashcards {{/str}}"
     data-voice-disabled="{{#str}} tts_voice_disabled, mod_flashcards {{/str}}"
     data-tts-success="{{#str}} tts_status_success, mod_flashcards {{/str}}"
     data-tts-error="{{#str}} tts_status_error, mod_flashcards {{/str}}"
     data-translation-idle="{{#str}} front_translation_status_idle, mod_flashcards {{/str}}"
     data-translation-loading="{{#str}} front_translation_status_loading, mod_flashcards {{/str}}"
     data-translation-error="{{#str}} front_translation_status_error, mod_flashcards {{/str}}"
     data-translation-reverse-hint="{{#str}} front_translation_reverse_hint, mod_flashcards {{/str}}"
     data-front-trans-show="{{#str}} front_translation_toggle_show, mod_flashcards {{/str}}"
     data-front-trans-hide="{{#str}} front_translation_toggle_hide, mod_flashcards {{/str}}"
     data-private-audio-label="{{#str}} private_audio_label, mod_flashcards {{/str}}"
     data-stt-idle="{{#str}} whisper_status_idle, mod_flashcards {{/str}}"
     data-stt-uploading="{{#str}} whisper_status_uploading, mod_flashcards {{/str}}"
     data-stt-transcribing="{{#str}} whisper_status_transcribing, mod_flashcards {{/str}}"
     data-stt-success="{{#str}} whisper_status_success, mod_flashcards {{/str}}"
     data-stt-error="{{#str}} whisper_status_error, mod_flashcards {{/str}}"
     data-stt-limit="{{#str}} whisper_status_limit, mod_flashcards {{/str}}"
     data-stt-quota="{{#str}} whisper_status_quota, mod_flashcards {{/str}}"
     data-stt-disabled="{{#str}} whisper_status_disabled, mod_flashcards {{/str}}"
     data-stt-retry="{{#str}} whisper_status_retry, mod_flashcards {{/str}}"
     data-stt-undo="{{#str}} whisper_status_undo, mod_flashcards {{/str}}"
     data-ocr-idle="{{#str}} ocr_status_idle, mod_flashcards {{/str}}"
     data-ocr-processing="{{#str}} ocr_status_processing, mod_flashcards {{/str}}"
     data-ocr-success="{{#str}} ocr_status_success, mod_flashcards {{/str}}"
     data-ocr-error="{{#str}} ocr_status_error, mod_flashcards {{/str}}"
     data-ocr-disabled="{{#str}} ocr_status_disabled, mod_flashcards {{/str}}"
     data-ocr-retry="{{#str}} ocr_status_retry, mod_flashcards {{/str}}"
     data-ocr-undo="{{#str}} ocr_status_undo, mod_flashcards {{/str}}"
     data-ordbokene-citation="{{#str}} ordbokene_citation, mod_flashcards {{/str}}">
  <div class="wrap">
    <div id="srStatus" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
    <!-- Access Status Banner -->
    <div id="accessStatusBanner" class="access-status-banner hidden">
      <div class="access-status-content">
        <div class="access-status-icon" id="accessStatusIcon">‚ÑπÔ∏è</div>
        <div class="access-status-text">
          <div class="access-status-title" id="accessStatusTitle"></div>
          <div class="access-status-desc" id="accessStatusDesc"></div>
        </div>
        <div class="access-status-actions" id="accessStatusActions"></div>
      </div>
    </div>

    <div class="tabs-toolbar">
      <div class="tabs-toolbar-top">
        <span class="tabs-toolbar-title" aria-label="Min gullfiskhukommelse">
          <span class="tabs-toolbar-title__word" aria-hidden="true">Min</span>
          <span class="tabs-toolbar-title__icon" aria-hidden="true">
            <img src="../pix/gullfisk.svg" alt="">
          </span>
          <span class="tabs-toolbar-title__word" aria-hidden="true">hukommelse</span>
        </span>
        <div class="header-metrics" aria-label="{{#str}} header_stats, mod_flashcards {{/str}}">
          <span class="header-stat" title="{{#str}} dashboard_active_vocab, mod_flashcards {{/str}}">
            <span class="header-stat-icon">&#128483;&#65038;</span>
            <span id="headerActiveVocab">0</span>
          </span>
          <span class="header-stat" title="Current Streak">
            <span class="header-stat-icon">&#128293;</span>
            <span id="headerStreak">0</span>
          </span>
        </div>
        <div class="header-controls">
          <div class="header-settings">
            <button type="button"
                    id="prefsToggle"
                    class="header-hexagon"
                    aria-expanded="false"
                    aria-controls="prefsPanel"
                    aria-label="{{#str}} preferences_toggle_label, mod_flashcards {{/str}}">
              <span aria-hidden="true" class="hexagon-icon">‚öô</span>
            </button>
            <div id="prefsPanel" class="header-pref-panel" role="region" aria-label="{{#str}} header_preferences_label, mod_flashcards {{/str}}">
              <div class="pref-page-shell">
                <div class="pref-page-content" id="prefsPageContent">
                  <div class="pref-floating-bar">
                    <button type="button" class="pref-close-btn" id="prefsClose" aria-label="{{#str}} back, mod_flashcards {{/str}}">
                      <span class="pref-close-icon" aria-hidden="true">&#8592;</span>
                      <span class="pref-close-text">{{#str}} back, mod_flashcards {{/str}}</span>
                    </button>
                    <div class="pref-page-title">{{#str}} settings_page_label, mod_flashcards {{/str}}</div>
                  </div>

                  <div id="prefsMain" class="pref-panel-main pref-page-section">
                    <div class="pref-card">
                      <div class="pref-card-title" data-i18n="font_scale_label">{{#str}} font_scale_label, mod_flashcards {{/str}}</div>
                      <div class="pref-card-body">
                        <div class="pref-field pref-font-field">
                          <label class="pref-label sr-only">{{#str}} font_scale_label, mod_flashcards {{/str}}</label>
                          <div class="pref-font-buttons" role="group" aria-label="{{#str}} font_scale_label, mod_flashcards {{/str}}">
                            <button type="button" class="pref-font-btn" data-scale="100" aria-pressed="true">
                              <span class="font-icon font-small">Aa</span>
                            </button>
                            <button type="button" class="pref-font-btn" data-scale="115" aria-pressed="false">
                              <span class="font-icon font-medium">Aa</span>
                            </button>
                            <button type="button" class="pref-font-btn" data-scale="130" aria-pressed="false">
                              <span class="font-icon font-large">Aa</span>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="pref-card">
                      <div class="pref-card-title" data-i18n="interface_language_label">{{#str}} interface_language_label, mod_flashcards {{/str}}</div>
                      <div class="pref-card-body pref-card-body-grid">
                        <div class="pref-field pref-language-field">
                          <label class="pref-label sr-only" for="langSel">{{#str}} interface_language_label, mod_flashcards {{/str}}</label>
                          <select id="langSel" title="{{#str}} interface_language_label, mod_flashcards {{/str}}">
                            <option value="en">EN</option>
                            <option value="uk">UK</option>
                            <option value="ru">RU</option>
                            <option value="fr">FR</option>
                            <option value="es">ES</option>
                            <option value="pl">PL</option>
                            <option value="it">IT</option>
                            <option value="de">DE</option>
                          </select>
                          <button type="button" id="langBtnMobile" class="language-btn-mobile" aria-label="{{#str}} interface_language_label, mod_flashcards {{/str}}">
                            EN
                          </button>
                        </div>
                        <div class="pref-field pref-voice-field">
                          <div class="pref-heading" data-i18n="tts_voice">{{#str}} tts_voice, mod_flashcards {{/str}}</div>
                          <label class="pref-label sr-only" for="ttsVoice">{{#str}} tts_voice, mod_flashcards {{/str}}</label>
                          <select id="ttsVoice"></select>
                          <div class="small" id="ttsVoiceStatus" aria-live="polite"></div>
                        </div>
                      </div>
                    </div>

                    <div class="pref-card pref-card-gesture-link">
                      <div class="pref-card-body">
                        <button type="button" class="pref-gestures-toggle" id="gesturePrefsToggle" aria-haspopup="true" aria-expanded="false">
                          <span data-i18n="gestures_heading">Gesture Controls</span>
                          <span class="pref-gestures-toggle-icon" aria-hidden="true">&#8250;</span>
                        </button>
                      </div>
                    </div>
                  </div>

                  <div class="pref-gesture-submenu" id="gestureSubmenu" aria-hidden="true">
                    <div class="pref-card pref-card-gesture">
                      <div class="pref-submenu-header">
                        <button type="button" class="pref-submenu-back" id="gestureSubmenuBack">
                          <span class="pref-submenu-back-icon" aria-hidden="true">&#8592;</span>
                          <span data-i18n="back">{{#str}} back, mod_flashcards {{/str}}</span>
                        </button>
                        <div class="pref-card-title" data-i18n="gestures_heading">Gesture Controls</div>
                      </div>
                      <div class="pref-card-body">
                        <div class="pref-gesture-config" id="gestureConfigPanel">
                          <label class="pref-checkbox-label">
                            <input type="checkbox" id="settingGesturesEnabled" checked>
                            <span data-i18n="gestures_enabled">Enable swipe gestures</span>
                          </label>

                          <label class="pref-checkbox-label">
                            <input type="checkbox" id="settingTapToReveal" checked>
                            <span data-i18n="gesture_tap_reveal">Tap card to reveal next</span>
                          </label>

                          <label class="pref-checkbox-label">
                            <input type="checkbox" id="settingLongPressMenu" checked>
                            <span data-i18n="gesture_long_press">Long press for menu</span>
                          </label>

                          <label class="pref-checkbox-label">
                            <input type="checkbox" id="settingDoubleTapAudio" checked>
                            <span data-i18n="gesture_double_tap">Double tap to replay audio</span>
                          </label>

                          <div class="pref-gesture-row pref-sensitivity-row">
                            <label class="pref-gesture-label">
                              <span data-i18n="gesture_sensitivity">Swipe Sensitivity</span>
                              <input type="range" id="settingSensitivity" min="0.3" max="1.0" step="0.1" value="0.5" class="pref-sensitivity-slider">
                              <span class="pref-sensitivity-value" id="sensitivityValue">Medium</span>
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <nav class="fc-tabs" role="tablist">
        <button class="fc-tab fc-tab-active" id="tabQuickInput" role="tab" aria-selected="true" aria-controls="quickInputSection">
          <span class="fc-tab-icon icon-plus">&#10133;</span>
          <span class="fc-tab-label" id="t_tab_quickinput">{{#str}} tab_quickinput, mod_flashcards {{/str}}</span>
        </button>
        <button class="fc-tab" id="tabStudy" role="tab" aria-selected="false" aria-controls="studySection">
          <span class="fc-tab-icon">&#128218;</span>
          <span class="fc-tab-label" id="t_tab_study">{{#str}} tab_study, mod_flashcards {{/str}}</span>
          <span class="fc-tab-badge hidden" id="studyBadge"></span>
        </button>
        <button class="fc-tab" id="tabDashboard" role="tab" aria-selected="false" aria-controls="dashboardSection">
          <span class="fc-tab-icon">&#128200;</span>
          <span class="fc-tab-label" id="t_tab_dashboard">{{#str}} tab_dashboard, mod_flashcards {{/str}}</span>
        </button>
      </nav>
    </div>

    <div class="row hidden">
      <select id="deckSelect"></select>
      <button id="btnActivate">{{#str}} activate, mod_flashcards {{/str}}</button>
      <span id="badge" class="pill">{{#str}} choose, mod_flashcards {{/str}}</span>
      <span id="dueInfo" class="pill" data-label="{{#str}} list_due, mod_flashcards {{/str}}">{{#str}} due, mod_flashcards {{/str}}</span>
      <label class="pill"><input id="packFile" type="file" accept="application/json"><span id="t_loadPack">{{#str}} loadpack, mod_flashcards {{/str}}</span></label>
    </div>

    <!-- Quick Input Section (Default) -->
    <div class="fc-tab-content fc-tab-active" id="quickInputSection" role="tabpanel" aria-labelledby="tabQuickInput">
      <div class="fc-editor-wrap">
        <div class="card" id="cardCreationFormWrap">
          <div class="card-form-content" id="cardCreationForm">
            <button id="btnStop" class="iconbtn hidden" title="{{#str}} title_stop, mod_flashcards {{/str}}" aria-label="{{#str}} title_stop, mod_flashcards {{/str}}">&#9209;</button>
            <input id="uAudio" type="file" accept="audio/mpeg,audio/mp3,audio/wav,audio/ogg,audio/m4a,audio/aac" class="hidden">
            <input id="uImage" type="file" accept="image/*" class="hidden">
            <img id="imgPrev" class="media hidden" alt=""/>
            <div class="slot front-slot">
              <div class="slot-head slot-head-stacked slot-head-inline">
                <div class="slot-head-row slot-head-inline-row translation-header">
              <div class="slot-head-main">
                <span class="tag" id="t_frontText" data-i18n="front">{{#str}} front, mod_flashcards {{/str}}</span>
              </div>
              <div class="slot-head-extra">
                <button type="button" id="toggleErrorCheckBtn" class="error-check-toggle-btn status-inline-toggle" aria-controls="errorCheckBlock" aria-expanded="false" title="{{#str}} error_check_toggle_label, mod_flashcards {{/str}}" style="display:none;">
                  <span class="error-check-toggle-icon" aria-hidden="true">&#9776;</span>
                  <span class="sr-only">{{#str}} error_check_toggle_label, mod_flashcards {{/str}}</span>
                </button>
                <span class="status-chip translation-status" id="mediaStatusIndicator">Status</span>
                <button type="button" id="btnQuickFormReset" class="ghost icon-only translation-reset translation-reset-small" title="{{#str}} resetform, mod_flashcards {{/str}}" aria-label="{{#str}} resetform, mod_flashcards {{/str}}" hidden>
                  <span aria-hidden="true">&#8634;</span>
                  <span class="sr-only">{{#str}} resetform, mod_flashcards {{/str}}</span>
                </button>
              </div>
            </div>
          </div>
          <div class="fokus-input-wrap front-input-wrap">
            <div id="errorCheckBlock" class="error-check-block error-check-collapsed" style="display:none;" aria-live="polite">
              <div class="error-check-content"></div>
            </div>
            <textarea id="uFront" class="autogrow" placeholder="Front..." data-i18n-placeholder="front_placeholder" autofocus></textarea>
          </div>
          <div class="front-text-actions">
            <div class="translation-mode translation-mode-inline">
              <button type="button" class="translation-mode-btn" data-dir="no-user" data-translation-btn>
                <span class="translation-mode-label" id="translationModeForward">Norsk > English</span>
              </button>
            </div>
            <button type="button" id="checkTextBtn" class="btn btn-sm btn-secondary check-text-btn">
              <span class="btn-icon" aria-hidden="true">&#128269;</span>
              <span data-i18n="check_text">Sjekk teksten</span>
            </button>
          </div>
        </div>
        <div class="slot front-translation-slot" id="slot_front_translation">
          <div class="slot-head-row slot-head-inline-row">
            <div class="slot-head-main">
              <span class="tag" id="tag_trans_local" data-i18n="back">{{#str}} back, mod_flashcards {{/str}}</span>
            </div>
          </div>
          <textarea id="uTransLocal" class="autogrow" placeholder="Translation..." data-i18n-placeholder="translation_placeholder"></textarea>
              <div class="translation-actions">
                <div class="translation-mode translation-mode-inline">
                  <button type="button" class="translation-mode-btn" data-dir="user-no" data-translation-btn>
                    <span class="translation-mode-label" id="translationModeReverse">English > Norsk</span>
                  </button>
                </div>
              <div class="translation-media-controls">
                <button id="btnImagePicker" class="fc-quick-media-btn fc-media-inline" title="{{#str}} title_camera, mod_flashcards {{/str}}" aria-label="{{#str}} title_camera, mod_flashcards {{/str}}">
                  <span class="fc-media-icon">&#128247;</span>
                </button>
                <div class="rec-control">
                  <span id="recTimer" class="rec-timer hidden" aria-live="polite" role="status">00:00</span>
                  <button id="btnRec" class="fc-quick-media-btn fc-media-inline micbtn" title="{{#str}} title_record, mod_flashcards {{/str}}" aria-label="{{#str}} title_record, mod_flashcards {{/str}}">
                    <span class="fc-media-icon">&#127897;&#65039;</span>
                  </button>
                  <div id="recLockHint" class="rec-lock-hint hidden" aria-hidden="true">
                    <div class="rec-lock-rail">
                      <div class="rec-lock-progress"></div>
                      <div class="rec-lock-thumb">
                        <span class="rec-lock-emoji" aria-hidden="true">&#128274;</span>
                        <span class="rec-lock-arrow" aria-hidden="true">&#8595;</span>
                      </div>
                    </div>
                    <div class="rec-lock-label">
                      <div class="rec-lock-label-title">Slide down to lock</div>
                      <div class="rec-lock-label-sub">Hold to start</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
              <div class="stt-status-wrap stt-status-block" aria-live="polite">
                <span id="sttStatus" class="stt-status-chip hidden" role="status"></span>
                <div class="stt-status-actions">
                  <button id="sttRetry" type="button" class="stt-link hidden status-action-btn">{{#str}} whisper_status_retry, mod_flashcards {{/str}}</button>
                  <button id="sttUndo" type="button" class="stt-link hidden status-action-btn">{{#str}} whisper_status_undo, mod_flashcards {{/str}}</button>
                  <button id="ocrRetry" type="button" class="stt-link hidden status-action-btn">{{#str}} ocr_status_retry, mod_flashcards {{/str}}</button>
                  <button id="ocrUndo" type="button" class="stt-link hidden status-action-btn">{{#str}} ocr_status_undo, mod_flashcards {{/str}}</button>
                </div>
              </div>
            </div>
            <div class="slot focus-helper-slot">
              <div class="focus-helper-head">
                <span class="tag" data-i18n="choose_focus_word">{{#str}} choose_focus_word, mod_flashcards {{/str}}</span>
              </div>
              <div id="focusWordList" class="focus-word-list"></div>
              <div id="focusHelperStatus" class="focus-helper-status small"></div>
            </div>
            <div class="slot">
              <span class="tag" data-i18n="fokus">{{#str}} fokus, mod_flashcards {{/str}}</span>
              <div class="fokus-input-wrap">
                <textarea id="uFokus" class="autogrow" placeholder="Fokus word/phrase..." data-i18n-placeholder="focus_placeholder"></textarea>
                <div id="fokusSuggest" class="fokus-suggest front-suggest" data-front-suggest></div>
              </div>
            </div>
            <div class="slot" id="slot_focus_analysis">
              <div class="analysis-header">
                <span class="tag" data-i18n="sentence_analysis">{{#str}} sentence_analysis, mod_flashcards {{/str}}</span>
              </div>
              <div id="focusAnalysisList" class="analysis-list" aria-live="polite"></div>
            </div>
            <div class="slot" id="slot_ordbokene">
              <span class="tag" data-i18n="ordbokene_block_label">{{#str}} ordbokene_block_label, mod_flashcards {{/str}}</span>
              <div id="ordbokeneBlock" class="ordbokene-block" aria-live="polite"></div>
            </div>

            <div class="slot">
              <span class="tag" data-i18n="fokus">{{#str}} fokus, mod_flashcards {{/str}}</span>
              <div class="fokus-input-wrap">
                <textarea id="uFokus" class="autogrow" placeholder="Fokus word/phrase..." data-i18n-placeholder="focus_placeholder"></textarea>
                <div id="fokusSuggest" class="fokus-suggest front-suggest" data-front-suggest></div>
              </div>
            </div>
            <div class="slot" id="slot_compound_parts">
              <span class="tag" data-i18n="compound_parts">Ledd</span>
              <div id="compoundParts" class="ledd-parts" aria-live="polite"></div>
            </div>
            <div class="slot" id="slot_forms_preview">
              <span class="tag" data-i18n="forms_preview">Ordformer</span>
              <div id="formsPreview" class="forms-preview" aria-live="polite"></div>
            </div>
            <div class="slot">
              <span class="tag" data-i18n="transcription">{{#str}} transcription, mod_flashcards {{/str}}</span>
              <textarea id="uTranscription" class="autogrow" placeholder="[IPA e.g. /hu:s/]" data-i18n-placeholder="transcription_placeholder"></textarea>
            </div>
            <div class="translation-media-tts">
              <div class="fc-media-badges">
                <span id="audBadge" class="media-pill hidden"
                      role="button"
                      tabindex="0"
                      aria-pressed="false"
                      aria-label="{{#str}} front_audio_badge, mod_flashcards {{/str}}"
                      data-media-target="audPrev"
                      data-media-kind="front">
                  <span class="icon">&#127897;&#65039;</span>
                  <span id="audName" class="media-name"></span>
                  <button id="btnClearAud" class="iconbtn" title="Clear">&times;</button>
                </span>
                <span id="focusAudBadge" class="media-pill hidden"
                      role="button"
                      tabindex="0"
                      aria-pressed="false"
                      aria-label="{{#str}} focus_audio_badge, mod_flashcards {{/str}}"
                      data-media-target="focusAudPrev"
                      data-media-kind="focus">
                  <span class="icon">&#128266;</span>
                  <span id="focusAudName" class="media-name"></span>
                  <button id="btnClearFocusAud" class="iconbtn" title="Clear">&times;</button>
                </span>
                <span id="imgBadge" class="media-pill hidden">
                  <span class="icon">&#128247;</span>
                  <span id="imgName" class="media-name"></span>
                  <button id="btnClearImg" class="iconbtn" title="Clear">&times;</button>
                </span>
              </div>
              <div class="translation-audio-previews">
                <audio id="audPrev" class="hidden" preload="metadata" aria-hidden="true"></audio>
                <audio id="focusAudPrev" class="hidden" preload="metadata" aria-hidden="true"></audio>
              </div>
            </div>
            <div class="focus-translation-pill" id="focusTranslationPreview" aria-label="{{#str}} focus_translation_label, mod_flashcards {{/str}}">
              <span class="focus-translation-text" id="focusTranslationText">‚Äî</span>
            </div>
            <div class="slot">
              <span class="tag" data-i18n="examples">{{#str}} examples, mod_flashcards {{/str}}</span>
              <div id="examplesListQuick" style="display: flex; flex-direction: column; gap: 12px;"></div>
              <div style="margin-top: 8px; display: flex;">
                <button type="button" id="btnAddExampleQuick" class="fc-link-btn" style="font-size: 0.85em; padding: 4px 8px;">+ Add</button>
              </div>
              <textarea id="uExamples" class="hidden" aria-hidden="true" style="display:none"></textarea>
            </div>
            <div class="slot ai-question-slot">
              <div class="ai-question-head">
                <span class="tag" data-i18n="ai_question_label">{{#str}} ai_question_label, mod_flashcards {{/str}}</span>
              </div>
              <div class="ai-chat-pane" id="aiChatPane" role="log" aria-live="polite">
                <p class="ai-chat-empty">{{#str}} ai_chat_empty, mod_flashcards {{/str}}</p>
              </div>
              <textarea id="uAiQuestion" class="autogrow" placeholder="{{#str}} ai_question_placeholder, mod_flashcards {{/str}}" data-i18n-placeholder="ai_question_placeholder"></textarea>
              <div class="ai-chat-actions">
                <button type="button" id="btnAskAi" class="fc-link-btn" data-i18n="ai_question_button">{{#str}} ai_question_button, mod_flashcards {{/str}}</button>
              </div>
            </div>
            <div class="fc-quick-advanced-toggle">
              <button id="btnEditorAdvanced" class="fc-link-btn">
                <span id="editorAdvancedLabel" data-i18n="show_advanced">{{#str}} show_advanced, mod_flashcards {{/str}}</span>
              </button>
            </div>

            <div id="editorAdvancedFields" class="fc-quick-advanced hidden">
              <div class="slot" id="slot_translation_en">
                <span class="tag" data-i18n="back_en">Translation (English)</span>
                <textarea id="uTransEn" class="autogrow" placeholder="Translation (English)..." data-i18n-placeholder="translation_en_placeholder"></textarea>
              </div>
            <div class="slot">
              <span class="tag" id="t_explanationText" data-i18n="explanation">{{#str}} explanation, mod_flashcards {{/str}}</span>
              <textarea id="uExplanation" class="autogrow" placeholder="Explanation..." data-i18n-placeholder="explanation_placeholder"></textarea>
            </div>
            <div class="slot">
              <span class="tag" data-i18n="focus_baseform">{{#str}} focus_baseform, mod_flashcards {{/str}}</span>
              <textarea id="uFocusBase" class="autogrow" placeholder="{{#str}} focus_baseform_ph, mod_flashcards {{/str}}" data-i18n-placeholder="focus_baseform_ph"></textarea>
            </div>
            <div class="slot">
                <span class="tag" data-i18n="pos">{{#str}} pos, mod_flashcards {{/str}}</span>
                <select id="uPOS">
                  <option value="">-</option>
                  <option value="substantiv">Substantiv ? navn pa steder, personer, ting og fenomener</option>
                  <option value="adjektiv">Adjektiv ? beskriver substantiv</option>
                  <option value="pronomen">Pronomen ? settes i stedet for et substantiv</option>
                  <option value="determinativ">Determinativ ? bestemmer substantivet n?rmere</option>
                  <option value="verb">Verb ? navn pa en handling</option>
                  <option value="adverb">Adverb ? beskriver/modifiserer verb, adjektiv eller andre adverb</option>
                  <option value="preposisjon">Preposisjon ? forteller hvor verbet/substantivet befinner seg i forhold til et annet verb/substantiv i bade tid og rom</option>
                  <option value="konjunksjon">Konjunksjon ? binder sammen to og to ord av samme ordklasse eller to helsetninger</option>
                  <option value="subjunksjon">Subjunksjon ? innleder leddsetninger</option>
                  <option value="interjeksjon">Interjeksjon ? lydmalende ord, folelser eller meninger</option>
                  <option value="phrase">Phrase</option>
                </select>
                <div id="uPOSHelp" class="small"></div>
              </div>
              <div class="slot" id="slot_gender">
                <span class="tag" data-i18n="gender">{{#str}} gender, mod_flashcards {{/str}}</span>
                <select id="uGender">
                  <option value="">-</option>
                  <option value="hankjonn">hankj√∏nn</option>
                  <option value="hunkjonn">hunkj√∏nn</option>
                  <option value="intetkjonn">intetkj√∏nn</option>
                </select>
              </div>
              <div class="slot" id="slot_noun_forms">
                <span class="tag" data-i18n="noun_forms">{{#str}} noun_forms, mod_flashcards {{/str}}</span>
                <div class="grid-forms">
                  <label>Indef. singular<input id="uNounIndefSg" type="text"></label>
                  <label>Def. singular<input id="uNounDefSg" type="text"></label>
                  <label>Indef. plural<input id="uNounIndefPl" type="text"></label>
                  <label>Def. plural<input id="uNounDefPl" type="text"></label>
                </div>
              </div>
              <div class="slot" id="slot_verb_forms">
                <span class="tag" data-i18n="verb_forms">{{#str}} verb_forms, mod_flashcards {{/str}}</span>
                <div class="grid-forms">
                  <label>Infinitiv<input id="uVerbInfinitiv" type="text"></label>
                  <label>Presens<input id="uVerbPresens" type="text"></label>
                  <label>Preteritum<input id="uVerbPreteritum" type="text"></label>
                  <label>Perfektum partisipp<input id="uVerbPerfektum" type="text"></label>
                  <label>Imperativ<input id="uVerbImperativ" type="text"></label>
                </div>
              </div>
              <div class="slot" id="slot_adj_forms">
                <span class="tag" data-i18n="adj_forms">{{#str}} adj_forms, mod_flashcards {{/str}}</span>
                <div class="grid-forms">
                  <label>Positiv<input id="uAdjPositiv" type="text"></label>
                  <label>Komparativ<input id="uAdjKomparativ" type="text"></label>
                  <label>Superlativ<input id="uAdjSuperlativ" type="text"></label>
                </div>
              </div>
              <div class="slot">
                <span class="tag" data-i18n="collocations">{{#str}} collocations, mod_flashcards {{/str}}</span>
                <textarea id="uCollocations" class="autogrow" placeholder="collocations..." data-i18n-placeholder="collocations_placeholder"></textarea>
              </div>
              <div class="slot">
                <span class="tag" data-i18n="antonyms">{{#str}} antonyms, mod_flashcards {{/str}}</span>
                <textarea id="uAntonyms" class="autogrow" placeholder="antonyms..." data-i18n-placeholder="antonyms_placeholder"></textarea>
              </div>
              <div class="slot">
                <span class="tag" data-i18n="cognates">{{#str}} cognates, mod_flashcards {{/str}}</span>
                <textarea id="uCognates" class="autogrow" placeholder="cognates..." data-i18n-placeholder="cognates_placeholder"></textarea>
              </div>
              <div class="slot">
                <span class="tag" data-i18n="sayings">{{#str}} sayings, mod_flashcards {{/str}}</span>
                <textarea id="uSayings" class="autogrow" placeholder="sayings..." data-i18n-placeholder="sayings_placeholder"></textarea>
              </div>
              <div class="slot">
                <span class="tag" id="t_order" data-i18n="order">{{#str}} order, mod_flashcards {{/str}}</span>
                <div id="orderChips" class="chips">
                  <button class="chip" data-kind="audio_text"   id="chip_audio_text" data-i18n="order_audio_word">{{#str}} order_audio_word, mod_flashcards {{/str}}</button>
                  <button class="chip" data-kind="transcription" id="chip_transcription" data-i18n="transcription">{{#str}} transcription, mod_flashcards {{/str}}</button>
                  <button class="chip" data-kind="audio"        id="chip_audio" data-i18n="order_audio_text">{{#str}} order_audio_text, mod_flashcards {{/str}}</button>
                  <button class="chip" data-kind="text"         id="chip_text" data-i18n="front">{{#str}} front, mod_flashcards {{/str}}</button>
                  <button class="chip" data-kind="translation"  id="chip_translation" data-i18n="back">{{#str}} back, mod_flashcards {{/str}}</button>
                  <button class="chip chip-reset" id="chip_reset" title="Reset order">&#8634;</button>
                </div>
                <div class="small" id="orderPreview">{{#str}} order_audio_word, mod_flashcards {{/str}} ‚Üí {{#str}} transcription, mod_flashcards {{/str}} ‚Üí {{#str}} order_audio_text, mod_flashcards {{/str}} ‚Üí {{#str}} front, mod_flashcards {{/str}} ‚Üí {{#str}} back, mod_flashcards {{/str}}</div>
              </div>
            </div>

            <div class="row2">
              <button id="btnUpdate"
                      class="ok"
                      data-role="update"
                      title="{{#str}} update_disabled_hint, mod_flashcards {{/str}}"
                      data-i18n="update">{{#str}} update, mod_flashcards {{/str}}</button>
              <button id="btnAdd" class="mid" data-i18n="createnew">{{#str}} createnew, mod_flashcards {{/str}}</button>
            </div>
            <div class="mono" id="status"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Study Section -->
    <div class="fc-tab-content" id="studySection" role="tabpanel" aria-labelledby="tabStudy">
    <div class="grid">
      <div class="card">
        <div class="actionTop card-toolbar">
          <div class="card-toolbar-info">
            <div id="stageBadge" class="card-stage-chip hidden" role="status" aria-live="polite" aria-label="{{#str}} list_stage, mod_flashcards {{/str}}">
              <span id="stageEmoji" aria-hidden="true"></span>
              <span id="stageText">0</span>
            </div>
          </div>
          <div class="card-toolbar-actions">
            <button id="btnList" class="iconbtn" title="{{#str}} list, mod_flashcards {{/str}}" aria-label="{{#str}} list, mod_flashcards {{/str}}">&#128220;</button>
            <button id="btnEdit" class="iconbtn hidden" title="{{#str}} title_edit, mod_flashcards {{/str}}">
              <svg role="presentation" focusable="false" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0L14.8 4.34l3.75 3.75 2.16-2.16z"/>
              </svg>
              <span class="sr-only">{{#str}} title_edit, mod_flashcards {{/str}}</span>
            </button>
            <button id="btnDel" class="iconbtn cross hidden" title="{{#str}} title_del, mod_flashcards {{/str}}" aria-label="{{#str}} title_del, mod_flashcards {{/str}}">&#128465;</button>
          </div>
        </div>
        <video id="cam" class="hidden capture-video" autoplay playsinline muted></video>
        <div id="slotContainer"></div>
        <div class="playRow">
          <button id="btnPlay" class="iconbtn hidden" title="{{#str}} title_play, mod_flashcards {{/str}}">&#128266;</button>
          <button id="btnPlaySlow" class="iconbtn hidden" title="{{#str}} title_slow, mod_flashcards {{/str}}">&#128034;</button>
        </div>
        <button id="btnInstallApp" class="hidden install-btn install-btn-block" title="{{#str}} install_app, mod_flashcards {{/str}}">
          üì± {{#str}} install_app, mod_flashcards {{/str}}
        </button>
        <div id="iosInstallHint" class="ios-hint hidden" role="note">
          <button id="iosHintClose" class="ios-hint-close" title="Close" aria-label="Close">&times;</button>
          <div class="ios-hint-title">üì± {{#str}} ios_install_title, mod_flashcards {{/str}}</div>
          <div class="ios-hint-steps">
            <div class="ios-hint-line">
              <span class="ios-hint-step-prefix">{{#str}} ios_install_step1, mod_flashcards {{/str}}</span>
              <span class="step step-share">{{#str}} ios_share_button, mod_flashcards {{/str}}</span>
              <span class="ios-hint-step-suffix">{{#str}} ios_install_step1_suffix, mod_flashcards {{/str}}</span>
            </div>
            <div class="ios-hint-line">
              <span class="ios-hint-step-prefix">{{#str}} ios_install_step2, mod_flashcards {{/str}}</span>
              <span class="step step-add">{{#str}} ios_add_to_home, mod_flashcards {{/str}}</span>
              <span class="ios-hint-step-suffix">{{#str}} ios_install_step2_suffix, mod_flashcards {{/str}}</span>
            </div>
          </div>
        </div>
        <div id="emptyState" class="empty hidden">{{#str}} empty, mod_flashcards {{/str}}</div>
      </div>
      <!-- Card creation form (collapsible) -->
      <div class="card card-form-collapsed" id="cardCreationFormWrap">
        <div class="card-form-toggle" id="btnToggleForm">
          
          <div></div>
        </div>
        <div class="card-form-content" id="cardCreationForm">
          <div class="actionTop">
            <button id="btnFormReset" class="iconbtn ghost" title="Clear form"><span class="rot">&#8634;</span></button><button id="btnCancelEdit" class="iconbtn cross" title="Cancel" data-i18n-title="cancel">&times;</button>
          </div>
          <div class="slot">
            <span class="tag" id="t_addOwn">{{#str}} addown, mod_flashcards {{/str}}</span>
          </div>
        <div class="slot">
          <span class="tag" id="t_pickAudio">{{#str}} audio, mod_flashcards {{/str}}</span>
          <div class="previewRow">
            <input id="uAudio" type="file" accept="audio/*" class="hidden">
            <button id="btnChooseAud" class="btnFile">{{#str}} choosefile, mod_flashcards {{/str}}</button><span id="audName" class="fileName"></span>
            <button id="btnClearAud" class="iconbtn" title="Clear">&times;</button>
            <div class="rec-wrap">
              <div class="rec-control rec-control-inline">
                <span id="recTimer" class="rec-timer hidden" aria-live="polite" role="status">00:00</span>
                <div class="rec-buttons">
                  <button id="btnRec"  class="iconbtn micbtn" title="{{#str}} title_record, mod_flashcards {{/str}}" aria-label="{{#str}} title_record, mod_flashcards {{/str}}">&#127897;&#65039;</button>
                  <button id="btnStop" class="iconbtn hidden" title="{{#str}} title_stop, mod_flashcards {{/str}}" aria-label="{{#str}} title_stop, mod_flashcards {{/str}}">&#9209;</button>
                </div>
              </div>
              <div id="recHint" class="rec-hint">{{#str}} press_hold_to_record, mod_flashcards {{/str}}</div>
            </div>
          </div>
          <audio id="audPrev" class="hidden" controls preload="metadata"></audio>
        </div>
        <div class="slot">
          <span class="tag" id="t_pickPhoto">{{#str}} image, mod_flashcards {{/str}}</span>
          <div class="previewRow">
            <input id="uImage" type="file" accept="image/*" class="hidden">
            <button id="btnChooseImg" class="btnFile">{{#str}} choosefile, mod_flashcards {{/str}}</button><span id="imgName" class="fileName"></span>
            <button id="btnClearImg" class="iconbtn" title="Clear">&times;</button>
            <!-- Camera controls positioned near image picker -->
            <button id="btnOpenCam" class="iconbtn" title="{{#str}} title_camera, mod_flashcards {{/str}}">&#128247;</button>
            <button id="btnShot" class="iconbtn hidden" title="{{#str}} title_take, mod_flashcards {{/str}}">&#128248;</button>
            <button id="btnCloseCam" class="iconbtn cross hidden" title="{{#str}} title_closecam, mod_flashcards {{/str}}">&times;</button>
          </div>
          <img id="imgPrev" class="media hidden" alt=""/>
        </div>
        <div class="slot">
          <span class="tag" id="t_frontText" data-i18n="front">{{#str}} front, mod_flashcards {{/str}}</span>
          <div class="fokus-input-wrap front-input-wrap">
            <textarea id="uFront" class="autogrow" placeholder="Front..." data-i18n-placeholder="front_placeholder"></textarea>
          </div>
        </div>
        <div class="slot">
          <span class="tag" id="t_explanationText">{{#str}} explanation, mod_flashcards {{/str}}</span>
          <textarea id="uExplanation" class="autogrow" placeholder="Explanation..." data-i18n-placeholder="explanation_placeholder"></textarea>
        </div>
        <!-- Language-aware translation fields -->
        <div class="slot" id="slot_translation_local">
          <span class="tag" id="tag_trans_local">Translation (?)</span>
          <textarea id="uTransLocal" class="autogrow" placeholder="Translation..." data-i18n-placeholder="translation_placeholder"></textarea>
        </div>
        <div class="slot" id="slot_translation_en">
          <span class="tag" data-i18n="back_en">{{#str}} back_en, mod_flashcards {{/str}}</span>
          <textarea id="uTransEn" class="autogrow" placeholder="I love you" data-i18n-placeholder="translation_en_placeholder"></textarea>
        </div>
        <!-- Linguistic enrichment fields -->
        <div class="slot">
          <span class="tag">{{#str}} pos, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <div class="input-wrap">
              <select id="uPOS">
              <option value="">-</option>
              <option value="substantiv">Substantiv ? navn pa steder, personer, ting og fenomener</option>
              <option value="adjektiv">Adjektiv ? beskriver substantiv</option>
              <option value="pronomen">Pronomen ? settes i stedet for et substantiv</option>
              <option value="determinativ">Determinativ ? bestemmer substantivet n?rmere</option>
              <option value="verb">Verb ? navn pa en handling</option>
              <option value="adverb">Adverb ? beskriver/modifiserer verb, adjektiv eller andre adverb</option>
              <option value="preposisjon">Preposisjon ? forteller hvor verbet/substantivet befinner seg i forhold til et annet verb/substantiv i bade tid og rom</option>
              <option value="konjunksjon">Konjunksjon ? binder sammen to og to ord av samme ordklasse eller to helsetninger</option>
              <option value="subjunksjon">Subjunksjon ? innleder leddsetninger</option>
              <option value="interjeksjon">Interjeksjon ? spesielle ord som gir et bilde av lyder som ikke kan skrives, folelser eller meninger</option>
              <option value="phrase">Phrase</option>
            </select>
            </div>
          </div>
          <div id="uPOSHelp" class="small"></div>
        </div>
        <div class="slot hidden" id="slot_gender">
          <span class="tag">{{#str}} gender, mod_flashcards {{/str}}</span>
          <select id="uGender">
            <option value="">-</option>
            <option value="hankjonn">hankj√∏nn</option>
            <option value="hunkjonn">hunkj√∏nn</option>
            <option value="intetkjonn">intetkj√∏nn</option>
          </select>
        </div>
        <div class="slot hidden" id="slot_noun_forms">
          <span class="tag">{{#str}} noun_forms, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <input id="uNounIndefSg" type="text" placeholder="{{#str}} indef_sg, mod_flashcards {{/str}}">
            <input id="uNounDefSg" type="text" placeholder="{{#str}} def_sg, mod_flashcards {{/str}}">
            <input id="uNounIndefPl" type="text" placeholder="{{#str}} indef_pl, mod_flashcards {{/str}}">
            <input id="uNounDefPl" type="text" placeholder="{{#str}} def_pl, mod_flashcards {{/str}}">\n          </div>
        </div>
        <div class="slot hidden" id="slot_verb_forms">
          <span class="tag">{{#str}} verb_forms, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <input id="uVerbInfinitiv" type="text" placeholder="Infinitiv">
            <input id="uVerbPresens" type="text" placeholder="Presens">
            <input id="uVerbPreteritum" type="text" placeholder="Preteritum">
            <input id="uVerbPerfektum" type="text" placeholder="Perfektum partisipp">
            <input id="uVerbImperativ" type="text" placeholder="Imperativ">\n          </div>
        </div>
        <div class="slot hidden" id="slot_adj_forms">
          <span class="tag">{{#str}} adj_forms, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <input id="uAdjPositiv" type="text" placeholder="Positiv">
            <input id="uAdjKomparativ" type="text" placeholder="Komparativ">
            <input id="uAdjSuperlativ" type="text" placeholder="Superlativ">\n          </div>
        </div>
        <div class="slot">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span class="tag">{{#str}} collocations, mod_flashcards {{/str}}</span>
            <button type="button" id="btnAddCollocation" class="fc-link-btn" style="font-size: 0.85em; padding: 4px 8px;">+ Add</button>
          </div>
          <div id="collocationsList" style="display: flex; flex-direction: column; gap: 12px;"></div>
        </div>
        <div class="slot">
          <span class="tag">{{#str}} examples, mod_flashcards {{/str}}</span>
          <div id="examplesList" style="display: flex; flex-direction: column; gap: 12px;"></div>
          <div style="margin-top: 8px; display: flex;">
            <button type="button" id="btnAddExample" class="fc-link-btn" style="font-size: 0.85em; padding: 4px 8px;">+ Add</button>
          </div>
        </div>
        <div class="slot">
          <span class="tag">{{#str}} antonyms, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <textarea id="uAntonyms" class="autogrow" placeholder="one per line..." data-i18n-placeholder="one_per_line_placeholder"></textarea>\n          </div>
        </div>
        <div class="slot">
          <span class="tag" data-i18n="cognates">{{#str}} cognates, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <textarea id="uCognates" class="autogrow" placeholder="one per line..." data-i18n-placeholder="one_per_line_placeholder"></textarea>\n          </div>
        </div>
        <div class="slot">
          <span class="tag" data-i18n="sayings">{{#str}} sayings, mod_flashcards {{/str}}</span>
          <div class="row has-action">
            <textarea id="uSayings" class="autogrow" placeholder="one per line..." data-i18n-placeholder="one_per_line_placeholder"></textarea>\n          </div>
        </div>
        <div class="slot">
          <span class="tag" id="t_order" data-i18n="order">{{#str}} order, mod_flashcards {{/str}}</span>
          <div id="orderChips" class="chips">
            <button class="chip" data-kind="audio_text"   id="chip_audio_text" data-i18n="order_audio_word">{{#str}} order_audio_word, mod_flashcards {{/str}}</button>
            <button class="chip" data-kind="transcription" id="chip_transcription" data-i18n="transcription">{{#str}} transcription, mod_flashcards {{/str}}</button>
            <button class="chip" data-kind="audio"        id="chip_audio" data-i18n="order_audio_text">{{#str}} order_audio_text, mod_flashcards {{/str}}</button>
            <button class="chip" data-kind="text"         id="chip_text" data-i18n="front">{{#str}} front, mod_flashcards {{/str}}</button>
            <button class="chip" data-kind="translation"  id="chip_translation" data-i18n="back">{{#str}} back, mod_flashcards {{/str}}</button>
            <button class="chip chip-reset" id="chip_reset" title="Reset order">&#8634;</button>
          </div>
          <div class="small" id="orderPreview">{{#str}} order_audio_word, mod_flashcards {{/str}} ‚Üí {{#str}} transcription, mod_flashcards {{/str}} ‚Üí {{#str}} order_audio_text, mod_flashcards {{/str}} ‚Üí {{#str}} front, mod_flashcards {{/str}} ‚Üí {{#str}} back, mod_flashcards {{/str}}</div>
        </div>
        <div class="mono" id="status"></div>
        <div class="small" id="hintPerms">Open via HTTPS for camera/mic permissions.</div>
        </div>
      </div>
    </div>
    <div class="mono" id="debug"></div>
  </div>
  
  <!-- Fixed bottom action bar (feature-flagged via data-ux-bottom="1") -->
  <div id="bottomActions" class="bottom-panel bottom-actions hidden" hidden style="display:none" role="toolbar" aria-label="{{#str}} rating_actions, mod_flashcards {{/str}}">
    <button id="btnRevealNext" class="primary" data-i18n="showmore" hidden>{{#str}} showmore, mod_flashcards {{/str}}</button>
    <button id="btnEasyBottom" class="ok">
      <span class="rating-label" data-i18n="easy">{{#str}} easy, mod_flashcards {{/str}}</span>
      <span class="rating-hint" id="btnEasyHint" aria-live="polite"></span>
    </button>
    <button id="btnNormalBottom" class="mid">
      <span class="rating-label" data-i18n="normal">{{#str}} normal, mod_flashcards {{/str}}</span>
      <span class="rating-hint" id="btnNormalHint" aria-live="polite"></span>
    </button>
    <button id="btnHardBottom" class="hard">
      <span class="rating-label" data-i18n="hard">{{#str}} hard, mod_flashcards {{/str}}</span>
      <span class="rating-hint" id="btnHardHint" aria-live="polite"></span>
    </button>
  </div>
  <div id="metaRecorder" class="bottom-panel bottom-recorder rec-control rec-control-inline hidden" hidden role="toolbar" aria-label="{{#str}} record_practice, mod_flashcards {{/str}}">
    <span id="recTimerStudy" class="rec-timer hidden" aria-live="polite" role="status">00:00</span>
    <button id="btnRecordStudy" class="iconbtn micbtn" title="{{#str}} title_record_practice, mod_flashcards {{/str}}" aria-label="{{#str}} title_record_practice, mod_flashcards {{/str}}">&#127897;&#65039;</button>
  </div>
  <div id="ocrCropModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="ocrCropTitle">
    <div class="box ocr-crop-box">
      <div class="ocr-crop-body">
        <div class="ocr-crop-stage" aria-label="{{#str}} ocr_crop_hint, mod_flashcards {{/str}}">
          <div class="ocr-crop-surface" id="ocrCropStage">
            <canvas id="ocrCropCanvas" class="ocr-crop-canvas"></canvas>
            <div id="ocrCropRect" class="ocr-crop-rect">
              <div class="ocr-crop-handle handle-nw corner" data-handle="nw"></div>
              <div class="ocr-crop-handle handle-ne corner" data-handle="ne"></div>
              <div class="ocr-crop-handle handle-sw corner" data-handle="sw"></div>
              <div class="ocr-crop-handle handle-se corner" data-handle="se"></div>
              <div class="ocr-crop-handle handle-n edge" data-handle="n"></div>
              <div class="ocr-crop-handle handle-s edge" data-handle="s"></div>
              <div class="ocr-crop-handle handle-w edge" data-handle="w"></div>
              <div class="ocr-crop-handle handle-e edge" data-handle="e"></div>
            </div>
          </div>
        </div>
      </div>
      <div id="ocrCropToolbar" class="ocr-crop-toolbar">
        <button id="ocrCropUndo" class="ghost icon-only" aria-label="{{#str}} undo, mod_flashcards {{/str}}"><span aria-hidden="true">&#8634;</span></button>
        <button id="ocrCropCancel" class="ghost icon-only" aria-label="{{#str}} cancel, mod_flashcards {{/str}}"><span aria-hidden="true">&times;</span></button>
        <button id="ocrCropApply" class="ok">{{#str}} use_for_ocr, mod_flashcards {{/str}}</button>
      </div>
    </div>
  </div>
  <div id="listModal" class="modal modal-fullscreen" role="dialog" aria-modal="true">
    <div class="box">
      <div id="yui_3_18_1_1_1765121778773_21" class="row" style="justify-content:space-between;align-items:center;padding:0 12px">
        <div class="row" style="flex:1;min-width:0;align-items:center;gap:10px;flex-wrap:wrap">
          <select id="listFilterDue" style="padding:6px">
            <option value="all">All cards</option>
            <option value="due">Due only</option>
          </select>
          <span id="listCount" class="badge">0</span>
          <input id="listSearch" type="search" placeholder="{{#str}} search_ph, mod_flashcards {{/str}}" style="flex:1;min-width:220px;max-width:420px">
        </div>
        <button id="btnCloseList" class="iconbtn cross" title="{{#str}} close, mod_flashcards {{/str}}">&times;</button>
      </div>
      <div style="overflow:auto;margin-top:10px">
        <table class="table" id="listTable">
          <thead>
            <tr>
              <th id="thFront">Focus</th>
              <th id="thStage" style="width:80px;text-align:center;">Stage</th>
              <th id="thDue" style="width:120px;text-align:center;">Due</th>
              <th id="thActions" style="width:70px;text-align:center;">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="row" id="listPagination" style="margin-top:10px;justify-content:center;gap:10px;display:none">
        <button id="btnPagePrev" class="btn">Previous</button>
        <span id="pageInfo" class="badge">Page 1 of 1</span>
        <button id="btnPageNext" class="btn">Next</button>
      </div>
    </div>
  </div>
  </div>
  <!-- End Study Section -->

  <!-- Dashboard Section -->
  <div class="fc-tab-content" id="dashboardSection" role="tabpanel" aria-labelledby="tabDashboard">
    <div class="fc-dashboard-wrap">
      <div class="card">
        <!-- Stats Cards -->
        <div class="fc-stats-grid">
          <div class="fc-stat-card fc-stat-card-clickable fc-stat-card-combo"
               id="statCardTotal"
               role="button"
               tabindex="0"
               aria-label="{{#str}} dashboard_total_cards, mod_flashcards {{/str}} / {{#str}} dashboard_active_vocab, mod_flashcards {{/str}}">
            <div class="fc-stat-combo-row">
              <span class="fc-stat-chip icon-plus" aria-hidden="true"></span>
              <span class="fc-stat-value" id="statTotalCards">0</span>
              <span class="fc-stat-sep" aria-hidden="true">(</span>
              <span class="fc-stat-chip" aria-hidden="true">&#128483;&#65038;</span>
              <span class="fc-stat-value fc-stat-value-secondary" id="statActiveVocab">0</span>
              <span class="fc-stat-sep" aria-hidden="true">)</span>
            </div>
            <div class="fc-stat-label" id="t_stat_total_active">
              {{#str}} dashboard_total_cards, mod_flashcards {{/str}} / {{#str}} dashboard_active_vocab, mod_flashcards {{/str}}
            </div>
          </div>
          <div class="fc-stat-card fc-stat-streak">
            <div class="fc-stat-row">
              <span class="fc-stat-chip fc-stat-chip-lg" aria-hidden="true">&#128293;</span>
              <span class="fc-stat-value" id="statStreak">0</span>
            </div>
            <div class="fc-stat-label" id="t_stat_streak" data-i18n="dashboard_streak">{{#str}} dashboard_streak, mod_flashcards {{/str}}</div>
          </div>
        </div>

        <!-- Charts -->
        <div class="fc-charts-grid">
          <div class="fc-chart-card">
            <h3 id="t_chart_stages" data-i18n="dashboard_stage_chart">{{#str}} dashboard_stage_chart, mod_flashcards {{/str}}</h3>
            <canvas id="stageChart" width="300" height="300"></canvas>
          </div>
          <div class="fc-chart-card">
            <h3 id="t_chart_activity" data-i18n="dashboard_activity_chart">{{#str}} dashboard_activity_chart, mod_flashcards {{/str}}</h3>
            <canvas id="activityChart" width="400" height="300"></canvas>
          </div>
        </div>
      </div>

      <!-- Achievements -->
      <div class="card fc-achievements">
        <h3 id="t_achievements" data-i18n="dashboard_achievements">{{#str}} dashboard_achievements, mod_flashcards {{/str}}</h3>
        <div class="fc-achievement-grid">
          <div class="fc-achievement-card" id="achievement2">
            <div class="fc-achievement-icon">&#128293;</div>
            <div class="fc-achievement-title" id="t_ach2_title" data-i18n="achievement_week_warrior">{{#str}} achievement_week_warrior, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach2Progress">0/7</div>
          </div>

          <!-- Language Level Achievements -->
          <div class="fc-achievement-card" id="achievement5">
            <div class="fc-achievement-icon">üå±</div>
            <div class="fc-achievement-title" id="t_ach5_title" data-i18n="achievement_level_a0">{{#str}} achievement_level_a0, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach5Progress">0/100</div>
          </div>
          <div class="fc-achievement-card" id="achievement6">
            <div class="fc-achievement-icon">üåø</div>
            <div class="fc-achievement-title" id="t_ach6_title" data-i18n="achievement_level_a1">{{#str}} achievement_level_a1, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach6Progress">0/600</div>
          </div>
          <div class="fc-achievement-card" id="achievement7">
            <div class="fc-achievement-icon">üçÄ</div>
            <div class="fc-achievement-title" id="t_ach7_title" data-i18n="achievement_level_a2">{{#str}} achievement_level_a2, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach7Progress">0/1500</div>
          </div>
          <div class="fc-achievement-card" id="achievement8">
            <div class="fc-achievement-icon">üå≥</div>
            <div class="fc-achievement-title" id="t_ach8_title" data-i18n="achievement_level_b1">{{#str}} achievement_level_b1, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach8Progress">0/2500</div>
          </div>
          <div class="fc-achievement-card" id="achievement9">
            <div class="fc-achievement-icon">üèÜ</div>
            <div class="fc-achievement-title" id="t_ach9_title" data-i18n="achievement_level_b2">{{#str}} achievement_level_b2, mod_flashcards {{/str}}</div>
            <div class="fc-achievement-progress" id="ach9Progress">0/4500</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- End Dashboard Section -->

  </div>

<!-- Language selection modal (mobile) -->
<div id="languageModal" class="language-modal" role="dialog" aria-modal="true">
  <div class="language-modal-content">
    <div class="language-modal-title" data-i18n="interface_language_label">{{#str}} interface_language_label, mod_flashcards {{/str}}</div>
    <div class="language-modal-grid" id="languageModalGrid">
      <button type="button" class="language-modal-option" data-lang="en">
        <span class="language-modal-code">en</span>
        <span class="language-modal-name">English</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="uk">
        <span class="language-modal-code">uk</span>
        <span class="language-modal-name">Ukrainian</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="ru">
        <span class="language-modal-code">ru</span>
        <span class="language-modal-name">Russian</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="fr">
        <span class="language-modal-code">fr</span>
        <span class="language-modal-name">Francais</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="es">
        <span class="language-modal-code">es</span>
        <span class="language-modal-name">Espanol</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="pl">
        <span class="language-modal-code">pl</span>
        <span class="language-modal-name">Polski</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="it">
        <span class="language-modal-code">it</span>
        <span class="language-modal-name">Italiano</span>
      </button>
      <button type="button" class="language-modal-option" data-lang="de">
        <span class="language-modal-code">de</span>
        <span class="language-modal-name">Deutsch</span>
      </button>
    </div>
  </div>
</div>

<!-- Field prompt modal for staged tasks -->
<div id="fieldPrompt" class="modal" role="dialog" aria-modal="true">
  <div class="box" style="max-width:560px">
    <div class="row" style="justify-content:space-between;align-items:center">
      <strong id="fpTitle">{{#str}} fill_field, mod_flashcards {{/str}}</strong>
      <button id="fpClose" class="iconbtn cross">&times;</button>
    </div>
    <div id="fpBody" style="margin-top:10px"></div>
    <div class="row" style="gap:8px;margin-top:12px">
      <button id="fpSave" class="ok" data-i18n="save">{{#str}} save, mod_flashcards {{/str}}</button>
      <button id="fpSkip" class="mid" data-i18n="skip">{{#str}} skip, mod_flashcards {{/str}}</button>
    </div>
  </div>
</div>
