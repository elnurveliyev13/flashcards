# –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∫–Ω–æ–ø–∫–∏ PWA Install

## –ü—Ä–æ–±–ª–µ–º–∞
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞ —É –∞–¥–º–∏–Ω–∞ –Ω–∞ desktop
- ‚ùå –ö–Ω–æ–ø–∫–∞ –ù–ï –≤–∏–¥–Ω–∞ —É —Å—Ç—É–¥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–æ–π –∞–∫–∫–∞—É–Ω—Ç)
- ‚ùå –ö–Ω–æ–ø–∫–∞ –ù–ï –≤–∏–¥–Ω–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º (–¥–∞–∂–µ —É –∞–¥–º–∏–Ω–∞)

---

## –ü—Ä–∏—á–∏–Ω–∞
**Moodle –∫–µ—à–∏—Ä—É–µ—Ç JavaScript –∏ —à–∞–±–ª–æ–Ω—ã Mustache –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.**

---

## –†–µ—à–µ–Ω–∏–µ (3 —à–∞–≥–∞)

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à Moodle

**–í–∞—Ä–∏–∞–Ω—Ç A: CLI (–±—ã—Å—Ç—Ä–µ–µ)**
```bash
cd /path/to/moodle
php admin/cli/purge_caches.php
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
1. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. Site administration ‚Üí Development ‚Üí **Purge all caches**
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É

---

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–≥–∏–Ω

–í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ **2025103002** —Å debug –ª–æ–≥–∞–º–∏.

```bash
cd /path/to/moodle
php admin/cli/upgrade.php
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –≤–µ–±: Site administration ‚Üí Notifications ‚Üí Upgrade

---

### –®–∞–≥ 3: –ü–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

**Desktop**:
- Chrome/Edge: `Ctrl + Shift + R` (Win) –∏–ª–∏ `Cmd + Shift + R` (Mac)

**Mobile**:
- Android Chrome: Settings ‚Üí Privacy ‚Üí Clear browsing data ‚Üí Cached images
- iOS Safari: Settings ‚Üí Safari ‚Üí Clear History and Website Data

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ (–≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞)

–û—Ç–∫—Ä–æ–π—Ç–µ F12 (DevTools) ‚Üí Console –∏ –Ω–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏:

```
[PWA] Install button in DOM: true          ‚Üê –ö–Ω–æ–ø–∫–∞ –Ω–∞–π–¥–µ–Ω–∞
[PWA] Service Worker support: true         ‚Üê PWA –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
[PWA] User agent: Mozilla/5.0 ...          ‚Üê –ë—Ä–∞—É–∑–µ—Ä
[PWA] ‚úÖ Install prompt available          ‚Üê –°–æ–±—ã—Ç–∏–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ (–∫–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞)
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `[PWA] Install button in DOM: false`**:
‚Üí –ö–µ—à Moodle –Ω–µ –æ—á–∏—â–µ–Ω, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –®–∞–≥ 1

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `[PWA] Install button in DOM: true`, –Ω–æ –ù–ï–¢ `‚úÖ Install prompt available`**:
‚Üí –ë—Ä–∞—É–∑–µ—Ä –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å PWA prompt (—Å–º. –Ω–∏–∂–µ)

---

## –ü–æ—á–µ–º—É —Å–æ–±—ã—Ç–∏–µ `beforeinstallprompt` –º–æ–∂–µ—Ç –ù–ï —Å—Ä–∞–±–æ—Ç–∞—Ç—å?

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ Chrome –¥–ª—è PWA:

1. ‚úÖ **HTTPS** (–∏–ª–∏ localhost)
2. ‚úÖ **Service Worker** –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
3. ‚úÖ **Manifest** –¥–æ—Å—Ç—É–ø–µ–Ω
4. ‚úÖ **Engagement**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª —Å —Å–∞–π—Ç–æ–º
5. ‚úÖ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ**

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

#### Desktop Chrome DevTools:
1. F12 ‚Üí **Application** ‚Üí **Manifest**
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∫–æ–Ω–∫–∏ 192x192 –∏ 512x512
   - Name: "–ö–∞—Ä—Ç–æ—á–∫–∏ SRS"

2. **Application** ‚Üí **Service Workers**
   - Status: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **activated and running**

3. **Console** ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   ```javascript
   navigator.serviceWorker.controller
   ```
   - –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ–±—ä–µ–∫—Ç (–Ω–µ null)

#### Mobile Chrome (—á–µ—Ä–µ–∑ USB debugging):
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Android –ø–æ USB
2. –ù–∞ –ü–ö: `chrome://inspect`
3. –í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Üí –æ—Ç–∫—Ä–æ–π—Ç–µ Moodle
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ –≤ DevTools

---

## –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º

### Android Chrome:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Moodle –≤ Chrome
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ **30-60 —Å–µ–∫—É–Ω–¥** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
3. –ü–æ—Å–∫—Ä–æ–ª–ª–∏—Ç–µ, –ø–æ–Ω–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
4. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (–ø–æ—Ç—è–Ω–∏—Ç–µ –≤–Ω–∏–∑)
5. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —á–µ—Ä–µ–∑ USB debugging
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `[PWA]`

### –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å:

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ**:
- Android: Settings ‚Üí Apps ‚Üí –Ω–∞–π–¥–∏—Ç–µ "–ö–∞—Ä—Ç–æ—á–∫–∏ SRS" –∏–ª–∏ "SRS Cards"
- –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí —É–¥–∞–ª–∏—Ç–µ, –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

## –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å **UI –∫–Ω–æ–ø–∫–∏** (–±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è):

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–±—Ä–∞—Ç—å –∫–ª–∞—Å—Å `hidden`

–í `templates/app.mustache`, —Å—Ç—Ä–æ–∫–∞ 86:

```html
<!-- –ë—ã–ª–æ -->
<button id="btnInstallApp" class="hidden install-btn" ...>

<!-- –°—Ç–∞–ª–æ (–≤—Ä–µ–º–µ–Ω–Ω–æ) -->
<button id="btnInstallApp" class="install-btn" ...>
```

–ö–Ω–æ–ø–∫–∞ –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ –≤—Å–µ–≥–¥–∞ (–¥–∞–∂–µ –µ—Å–ª–∏ PWA –Ω–µ –≥–æ—Ç–æ–≤–∞).

### –í–∞—Ä–∏–∞–Ω—Ç 2: –§–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫–∞–∑ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
document.getElementById('btnInstallApp')?.classList.remove('hidden');
```

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–∫–∏

–ï—Å–ª–∏ `beforeinstallprompt` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É:

```javascript
// –î–æ–±–∞–≤–∏—Ç—å –≤ flashcards.js –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 727:

// –ï—Å–ª–∏ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ —Å–æ–±—ã—Ç–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
setTimeout(() => {
  if (btnInstallApp && btnInstallApp.classList.contains('hidden')) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —ç—Ç–æ Android Chrome
    const isAndroidChrome = /Android/.test(navigator.userAgent) &&
                            /Chrome/.test(navigator.userAgent);
    if (isAndroidChrome) {
      console.log('[PWA] Event not fired. Show manual instruction?');
      // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å hint: "Tap ‚ãÆ menu ‚Üí Install app"
    }
  }
}, 10000);
```

---

## –ß–µ–∫–ª–∏—Å—Ç –æ—Ç–ª–∞–¥–∫–∏

### –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–æ–π –∞–∫–∫–∞—É–Ω—Ç):
- [ ] –ê–¥–º–∏–Ω –æ—á–∏—Å—Ç–∏–ª –∫–µ—à Moodle
- [ ] –ü–ª–∞–≥–∏–Ω –æ–±–Ω–æ–≤–ª—ë–Ω –¥–æ –≤–µ—Ä—Å–∏–∏ 2025103002
- [ ] –°—Ç—É–¥–µ–Ω—Ç –æ–±–Ω–æ–≤–∏–ª —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –æ—á–∏—Å—Ç–∫–æ–π –∫–µ—à–∞ (Ctrl+Shift+R)
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω–æ: `[PWA] Install button in DOM: true`
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ JavaScript –≤ –∫–æ–Ω—Å–æ–ª–∏

### –î–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ (Android Chrome):
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Chrome/Edge (–ù–ï Firefox/Safari)
- [ ] –û—Ç–∫—Ä—ã—Ç–æ –ø–æ HTTPS
- [ ] Service Worker –∞–∫—Ç–∏–≤–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ DevTools)
- [ ] Manifest –∑–∞–≥—Ä—É–∂–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ DevTools)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- [ ] –ü–æ–¥–æ–∂–¥–∞–ª–∏ 30-60 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- [ ] –û–±–Ω–æ–≤–∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### –î–ª—è iOS:
- ‚ö†Ô∏è **iOS –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `beforeinstallprompt`**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–±: Safari ‚Üí Share ‚Üí Add to Home Screen

---

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### Desktop (Chrome/Edge):
```
[PWA] Install button in DOM: true
[PWA] Service Worker support: true
[PWA] User agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) ...
[PWA] ‚úÖ Install prompt available - button shown
```
‚Üí –ö–Ω–æ–ø–∫–∞ "üì± Install App" –ø–æ—è–≤–∏–ª–∞—Å—å –≤ header

### Mobile Android (Chrome):
```
[PWA] Install button in DOM: true
[PWA] Service Worker support: true
[PWA] User agent: Mozilla/5.0 (Linux; Android 13; ...) Chrome/120.0 ...
[PWA] ‚úÖ Install prompt available - button shown
```
‚Üí –ö–Ω–æ–ø–∫–∞ "üì± Install App" –ø–æ—è–≤–∏–ª–∞—Å—å

### Mobile iOS (Safari):
```
[PWA] Install button in DOM: true
[PWA] Service Worker support: true
[PWA] User agent: Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 ...) Safari/604.1
```
‚Üí –°–æ–±—ã—Ç–∏–µ –ù–ï —Å—Ä–∞–±–æ—Ç–∞–µ—Ç (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è iOS)
‚Üí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Share ‚Üí Add to Home Screen

---

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –ü—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ (F12 ‚Üí Console)
2. –ü—Ä–∏—à–ª–∏—Ç–µ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥:
   ```bash
   php admin/cli/upgrade.php --version
   ls -la mod/flashcards/version.php
   cat mod/flashcards/version.php | grep version
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º:
   ```bash
   chmod -R 755 mod/flashcards
   ```

---

**–ê–≤—Ç–æ—Ä**: Claude
**–î–∞—Ç–∞**: 2025-10-30
**–í–µ—Ä—Å–∏—è –ø–ª–∞–≥–∏–Ω–∞**: 2025103002 (v0.6.1-pwa-debug)
